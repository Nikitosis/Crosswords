unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, Menus, ExtCtrls, jpeg, shellapi;

type
  TForm1 = class(TForm)
    Edit1: TEdit;
    OpenDialog1: TOpenDialog;
    SaveDialog1: TSaveDialog;
    Panel1: TPanel;
    Splitter1: TSplitter;
    Panel2: TPanel;
    ListBox1: TListBox;
    Panel3: TPanel;
    Image1: TImage;
    Panel4: TPanel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Button1: TButton;
    Label7: TLabel;
    Label8: TLabel;
    Panel5: TPanel;
    Image2: TImage;
    Panel6: TPanel;
    Image3: TImage;
    Panel7: TPanel;
    Image4: TImage;
    MainMenu1: TMainMenu;
    N1: TMenuItem;
    N2: TMenuItem;
    N3: TMenuItem;
    Timer1: TTimer;
    Edit2: TEdit;
    Edit3: TEdit;
    Edit4: TEdit;
    Edit5: TEdit;
    Edit6: TEdit;
    Edit7: TEdit;
    Edit8: TEdit;
    Edit9: TEdit;
    Edit10: TEdit;
    Edit11: TEdit;
    Edit12: TEdit;
    Edit13: TEdit;
    Edit14: TEdit;
    Edit15: TEdit;
    Edit16: TEdit;
    Edit17: TEdit;
    Edit18: TEdit;
    Edit19: TEdit;
    Edit20: TEdit;
    Edit21: TEdit;
    Edit22: TEdit;
    Edit23: TEdit;
    Edit24: TEdit;
    Edit25: TEdit;
    Edit26: TEdit;
    Edit27: TEdit;
    Edit28: TEdit;
    Edit29: TEdit;
    Edit30: TEdit;
    Edit31: TEdit;
    Edit32: TEdit;
    Edit33: TEdit;
    Edit34: TEdit;
    Edit35: TEdit;
    Edit36: TEdit;
    Edit37: TEdit;
    Edit38: TEdit;
    Edit39: TEdit;
    Edit40: TEdit;
    Edit41: TEdit;
    Edit42: TEdit;
    Edit43: TEdit;
    Edit44: TEdit;
    Edit45: TEdit;
    Edit46: TEdit;
    Edit47: TEdit;
    Edit48: TEdit;
    Edit49: TEdit;
    Edit50: TEdit;
    Edit51: TEdit;
    Edit52: TEdit;
    Edit53: TEdit;
    Edit54: TEdit;
    Edit55: TEdit;
    Edit56: TEdit;
    Edit57: TEdit;
    Edit58: TEdit;
    Edit59: TEdit;
    Edit60: TEdit;
    Edit61: TEdit;
    Edit62: TEdit;
    Edit63: TEdit;
    Edit64: TEdit;
    Edit65: TEdit;
    Edit66: TEdit;
    Edit67: TEdit;
    Edit68: TEdit;
    Edit69: TEdit;
    Edit70: TEdit;
    Edit71: TEdit;
    Edit72: TEdit;
    Edit73: TEdit;
    Edit74: TEdit;
    Edit75: TEdit;
    Edit76: TEdit;
    Edit77: TEdit;
    Edit78: TEdit;
    Edit79: TEdit;
    Edit80: TEdit;
    Edit81: TEdit;
    Edit82: TEdit;
    Edit83: TEdit;
    Edit84: TEdit;
    Edit85: TEdit;
    Edit86: TEdit;
    Edit87: TEdit;
    Edit88: TEdit;
    Edit89: TEdit;
    Edit90: TEdit;
    Edit91: TEdit;
    Edit92: TEdit;
    Edit93: TEdit;
    Edit94: TEdit;
    Edit95: TEdit;
    Edit96: TEdit;
    Edit97: TEdit;
    Edit98: TEdit;
    Edit99: TEdit;
    Edit100: TEdit;
    Edit101: TEdit;
    Edit102: TEdit;
    Edit103: TEdit;
    Edit104: TEdit;
    Edit105: TEdit;
    Edit106: TEdit;
    Edit107: TEdit;
    Edit108: TEdit;
    Edit109: TEdit;
    Edit110: TEdit;
    Edit111: TEdit;
    Edit112: TEdit;
    Edit113: TEdit;
    Edit114: TEdit;
    Edit115: TEdit;
    Edit116: TEdit;
    Edit117: TEdit;
    Edit118: TEdit;
    Edit119: TEdit;
    Edit120: TEdit;
    Edit121: TEdit;
    Edit122: TEdit;
    Edit123: TEdit;
    Edit124: TEdit;
    Edit125: TEdit;
    Edit126: TEdit;
    Edit127: TEdit;
    Edit128: TEdit;
    Edit129: TEdit;
    Edit130: TEdit;
    Edit131: TEdit;
    Edit132: TEdit;
    Edit133: TEdit;
    Edit134: TEdit;
    Edit135: TEdit;
    Edit136: TEdit;
    Edit137: TEdit;
    Edit138: TEdit;
    Edit139: TEdit;
    Edit140: TEdit;
    Edit141: TEdit;
    Edit142: TEdit;
    Edit143: TEdit;
    Edit144: TEdit;
    Edit145: TEdit;
    Edit146: TEdit;
    Edit147: TEdit;
    Edit148: TEdit;
    Edit149: TEdit;
    Edit150: TEdit;
    Edit151: TEdit;
    Edit152: TEdit;
    Edit153: TEdit;
    Edit154: TEdit;
    Edit155: TEdit;
    Edit156: TEdit;
    Edit157: TEdit;
    Edit158: TEdit;
    Edit159: TEdit;
    Edit160: TEdit;
    Edit161: TEdit;
    Edit162: TEdit;
    Edit163: TEdit;
    Edit164: TEdit;
    Edit165: TEdit;
    Edit166: TEdit;
    Edit167: TEdit;
    Edit168: TEdit;
    Edit169: TEdit;
    Edit170: TEdit;
    Edit171: TEdit;
    Edit172: TEdit;
    Edit173: TEdit;
    Edit174: TEdit;
    Edit175: TEdit;
    Edit176: TEdit;
    Edit177: TEdit;
    Edit178: TEdit;
    Edit179: TEdit;
    Edit180: TEdit;
    Edit181: TEdit;
    Edit182: TEdit;
    Edit183: TEdit;
    Edit184: TEdit;
    Edit185: TEdit;
    Edit186: TEdit;
    Edit187: TEdit;
    Edit188: TEdit;
    Edit189: TEdit;
    Edit190: TEdit;
    Edit191: TEdit;
    Edit192: TEdit;
    Edit193: TEdit;
    Edit194: TEdit;
    Edit195: TEdit;
    Edit196: TEdit;
    Edit197: TEdit;
    Edit198: TEdit;
    Edit199: TEdit;
    Edit200: TEdit;
    Edit201: TEdit;
    Edit202: TEdit;
    Edit203: TEdit;
    Edit204: TEdit;
    Edit205: TEdit;
    Edit206: TEdit;
    Edit207: TEdit;
    Edit208: TEdit;
    Edit209: TEdit;
    Edit210: TEdit;
    Edit211: TEdit;
    Edit212: TEdit;
    Edit213: TEdit;
    Edit214: TEdit;
    Edit215: TEdit;
    Edit216: TEdit;
    Edit217: TEdit;
    Edit218: TEdit;
    Edit219: TEdit;
    Edit220: TEdit;
    Edit221: TEdit;
    Edit222: TEdit;
    Edit223: TEdit;
    Edit224: TEdit;
    Edit225: TEdit;
    Edit226: TEdit;
    Edit227: TEdit;
    Edit228: TEdit;
    Edit229: TEdit;
    Edit230: TEdit;
    Edit231: TEdit;
    Edit232: TEdit;
    Edit233: TEdit;
    Edit234: TEdit;
    Edit235: TEdit;
    Edit236: TEdit;
    Edit237: TEdit;
    Edit238: TEdit;
    Edit239: TEdit;
    Edit240: TEdit;
    Edit241: TEdit;
    Edit242: TEdit;
    Edit243: TEdit;
    Edit244: TEdit;
    Edit245: TEdit;
    Edit246: TEdit;
    Edit247: TEdit;
    Edit248: TEdit;
    Edit249: TEdit;
    Edit250: TEdit;
    Edit251: TEdit;
    Edit252: TEdit;
    Edit253: TEdit;
    Edit254: TEdit;
    Edit255: TEdit;
    Edit256: TEdit;
    Edit257: TEdit;
    Edit258: TEdit;
    Edit259: TEdit;
    Edit260: TEdit;
    Edit261: TEdit;
    Edit262: TEdit;
    Edit263: TEdit;
    Edit264: TEdit;
    Edit265: TEdit;
    Edit266: TEdit;
    Edit267: TEdit;
    Edit268: TEdit;
    Edit269: TEdit;
    Edit270: TEdit;
    Edit271: TEdit;
    Edit272: TEdit;
    Edit273: TEdit;
    Edit274: TEdit;
    Edit275: TEdit;
    Edit276: TEdit;
    Edit277: TEdit;
    Edit278: TEdit;
    Edit279: TEdit;
    Edit280: TEdit;
    Edit281: TEdit;
    Edit282: TEdit;
    Edit283: TEdit;
    Edit284: TEdit;
    Edit285: TEdit;
    Edit286: TEdit;
    Edit287: TEdit;
    Edit288: TEdit;
    Edit289: TEdit;
    Edit290: TEdit;
    Edit291: TEdit;
    Edit292: TEdit;
    Edit293: TEdit;
    Edit294: TEdit;
    Edit295: TEdit;
    Edit296: TEdit;
    Edit297: TEdit;
    Edit298: TEdit;
    Edit299: TEdit;
    Edit300: TEdit;
    Edit301: TEdit;
    Edit302: TEdit;
    Edit303: TEdit;
    Edit304: TEdit;
    Edit305: TEdit;
    Edit306: TEdit;
    Edit307: TEdit;
    Edit308: TEdit;
    Edit309: TEdit;
    Edit310: TEdit;
    Edit311: TEdit;
    Edit312: TEdit;
    Edit313: TEdit;
    Edit314: TEdit;
    Edit315: TEdit;
    Edit316: TEdit;
    Edit317: TEdit;
    Edit318: TEdit;
    Edit319: TEdit;
    Edit320: TEdit;
    Edit321: TEdit;
    Edit322: TEdit;
    Edit323: TEdit;
    Edit324: TEdit;
    Edit325: TEdit;
    Edit326: TEdit;
    Edit327: TEdit;
    Edit328: TEdit;
    Edit329: TEdit;
    Edit330: TEdit;
    Edit331: TEdit;
    Edit332: TEdit;
    Edit333: TEdit;
    Edit334: TEdit;
    Edit335: TEdit;
    Edit336: TEdit;
    Edit337: TEdit;
    Edit338: TEdit;
    Edit339: TEdit;
    Edit340: TEdit;
    Edit341: TEdit;
    Edit342: TEdit;
    Edit343: TEdit;
    Edit344: TEdit;
    Edit345: TEdit;
    Edit346: TEdit;
    Edit347: TEdit;
    Edit348: TEdit;
    Edit349: TEdit;
    Edit350: TEdit;
    Edit351: TEdit;
    Edit352: TEdit;
    Edit353: TEdit;
    Edit354: TEdit;
    Edit355: TEdit;
    Edit356: TEdit;
    Edit357: TEdit;
    Edit358: TEdit;
    Edit359: TEdit;
    Edit360: TEdit;
    Edit361: TEdit;
    Edit362: TEdit;
    Edit363: TEdit;
    Edit364: TEdit;
    Edit365: TEdit;
    Edit366: TEdit;
    Edit367: TEdit;
    Edit368: TEdit;
    Edit369: TEdit;
    Edit370: TEdit;
    Edit371: TEdit;
    Edit372: TEdit;
    Edit373: TEdit;
    Edit374: TEdit;
    Edit375: TEdit;
    Edit376: TEdit;
    Edit377: TEdit;
    Edit378: TEdit;
    Edit379: TEdit;
    Edit380: TEdit;
    Edit381: TEdit;
    Edit382: TEdit;
    Edit383: TEdit;
    Edit384: TEdit;
    Edit385: TEdit;
    Edit386: TEdit;
    Edit387: TEdit;
    Edit388: TEdit;
    Edit389: TEdit;
    Edit390: TEdit;
    Edit391: TEdit;
    Edit392: TEdit;
    Edit393: TEdit;
    Edit394: TEdit;
    Edit395: TEdit;
    Edit396: TEdit;
    Edit397: TEdit;
    Edit398: TEdit;
    Edit399: TEdit;
    Edit400: TEdit;
    Edit401: TEdit;
    Edit402: TEdit;
    Edit403: TEdit;
    Edit404: TEdit;
    Edit405: TEdit;
    Edit406: TEdit;
    Edit407: TEdit;
    Edit408: TEdit;
    Edit409: TEdit;
    Edit410: TEdit;
    Edit411: TEdit;
    Edit412: TEdit;
    Edit413: TEdit;
    Edit414: TEdit;
    Edit415: TEdit;
    Edit416: TEdit;
    Edit417: TEdit;
    Edit418: TEdit;
    Edit419: TEdit;
    Edit420: TEdit;
    Edit421: TEdit;
    Edit422: TEdit;
    Edit423: TEdit;
    Edit424: TEdit;
    Edit425: TEdit;
    Edit426: TEdit;
    Edit427: TEdit;
    Edit428: TEdit;
    Edit429: TEdit;
    Edit430: TEdit;
    Edit431: TEdit;
    Edit432: TEdit;
    Edit433: TEdit;
    Edit434: TEdit;
    Edit435: TEdit;
    Edit436: TEdit;
    Edit437: TEdit;
    Edit438: TEdit;
    Edit439: TEdit;
    Edit440: TEdit;
    Edit441: TEdit;
    Edit442: TEdit;
    Edit443: TEdit;
    Edit444: TEdit;
    Edit445: TEdit;
    Edit446: TEdit;
    Edit447: TEdit;
    Edit448: TEdit;
    Edit449: TEdit;
    Edit450: TEdit;
    Edit451: TEdit;
    Edit452: TEdit;
    Edit453: TEdit;
    Edit454: TEdit;
    Edit455: TEdit;
    Edit456: TEdit;
    Edit457: TEdit;
    Edit458: TEdit;
    Edit459: TEdit;
    Edit460: TEdit;
    Edit461: TEdit;
    Edit462: TEdit;
    Edit463: TEdit;
    Edit464: TEdit;
    Edit465: TEdit;
    Edit466: TEdit;
    Edit467: TEdit;
    Edit468: TEdit;
    Edit469: TEdit;
    Edit470: TEdit;
    Edit471: TEdit;
    Edit472: TEdit;
    Edit473: TEdit;
    Edit474: TEdit;
    Edit475: TEdit;
    Edit476: TEdit;
    Edit477: TEdit;
    Edit478: TEdit;
    Edit479: TEdit;
    Edit480: TEdit;
    Edit481: TEdit;
    Edit482: TEdit;
    Edit483: TEdit;
    Edit484: TEdit;
    Edit485: TEdit;
    Edit486: TEdit;
    Edit487: TEdit;
    Edit488: TEdit;
    Edit489: TEdit;
    Edit490: TEdit;
    Edit491: TEdit;
    Edit492: TEdit;
    Edit493: TEdit;
    Edit494: TEdit;
    Edit495: TEdit;
    Edit496: TEdit;
    Edit497: TEdit;
    Edit498: TEdit;
    Edit499: TEdit;
    Edit500: TEdit;
    Edit501: TEdit;
    Edit502: TEdit;
    Edit503: TEdit;
    Edit504: TEdit;
    N4: TMenuItem;
    N5: TMenuItem;
    N6: TMenuItem;
    Timer2: TTimer;
    Label1: TLabel;
    Label9: TLabel;
    procedure FormCreate(Sender: TObject);
    procedure N2Click(Sender: TObject);
    procedure Edit1Change(Sender: TObject);
    procedure Splitter1Moved(Sender: TObject);
    procedure ListBox1Click(Sender: TObject);
    procedure FormClick(Sender: TObject);
    procedure Edit1Click(Sender: TObject);
    procedure Image1Click(Sender: TObject);
    procedure N3Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure Edit1KeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure N5Click(Sender: TObject);
    procedure Timer2Timer(Sender: TObject);
    procedure N6Click(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;

type Tword=record
           numfirst,length,direction:integer;
           question:string;
           end;
var
  Form1: TForm1;
  Editsamount,wordsAmount,wasWrong,wrongTries:integer;     //waswrong-кол-во неправильных слов было
  Edits:array [-30..600] of TEdit;
  Words:array [1..600] of Tword;
  Letters:array [1..600] of string;
  time:integer;
  const EDINLINE=28;

implementation

uses Unit2;

{$R *.dfm}


///////////////////////////
///////////////////////////
//////////////////////////

function isWordFull(num:integer):boolean;
var i:integer;
begin
  case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i*EDINLINE].Text='' then begin
                                                      isWordFull:=false;
                                                      exit;
                                                      end;
  2:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i].Text='' then  begin
                                                      isWordFull:=false;
                                                      exit;
                                                      end;
  3:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i].Text='' then begin
                                                      isWordFull:=false;
                                                      exit;
                                                      end;
  4:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i*EDINLINE].Text='' then begin
                                                      isWordFull:=false;
                                                      exit;
                                                      end;
     end;
  isWordFull:=true;
end;

function isWordRight(num:integer):boolean;
var i:integer;
begin
   case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i*EDINLINE].Text<>Letters[Words[num].numfirst+i*EDINLINE] then begin
                                                                                       isWordRight:=false;
                                                                                       exit;
                                                                                       end;
  2:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i].Text<>Letters[Words[num].numfirst-i] then  begin
                                                                                   isWordRight:=false;
                                                                                   exit;
                                                                                   end;
  3:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i].Text<>Letters[Words[num].numfirst+i] then begin
                                                                                isWordRight:=false;
                                                                                exit;
                                                                                 end;
  4:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i*EDINLINE].Text<>Letters[Words[num].numfirst-i*EDINLINE] then begin
                                                                                     isWordRight:=false;
                                                                                     exit;
                                                                                     end;
     end;
  isWordRight:=true;
end;

procedure paintGreen(num:integer);
var i:integer;
begin
  case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
     Edits[Words[num].numfirst+i*EDINLINE].Color:=clGreen;

  2:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst-i].Color:=clGreen;

  3:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst+i].Color:=clGreen;

  4:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst-i*EDINLINE].Color:=clGreen;
     end;
end;

procedure paintRed(num:integer);
var i:integer;
begin
  case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
     if  Edits[Words[num].numfirst+i*EDINLINE].Color<>clGreen then Edits[Words[num].numfirst+i*EDINLINE].Color:=clRed;

  2:for i:=0 to Words[num].length-1 do
    if Edits[Words[num].numfirst-i].Color<>clGreen then Edits[Words[num].numfirst-i].Color:=clRed;

  3:for i:=0 to Words[num].length-1 do
     if Edits[Words[num].numfirst+i].Color<>clGreen then  Edits[Words[num].numfirst+i].Color:=clRed;

  4:for i:=0 to Words[num].length-1 do
     if Edits[Words[num].numfirst-i*EDINLINE].Color<>clGreen then Edits[Words[num].numfirst-i*EDINLINE].Color:=clRed;
     end;
end;

procedure paintWhite(num:integer);
var i:integer;
begin
  case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst+i*EDINLINE].Color:=clWindow;

  2:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst-i].Color:=clWindow;

  3:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst+i].Color:=clWindow;

  4:for i:=0 to Words[num].length-1 do
      Edits[Words[num].numfirst-i*EDINLINE].Color:=clWindow;
     end;
end;

function isWordGreen(num:integer):boolean;
var i:integer;
begin
  case Words[num].direction of
  1: for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i*EDINLINE].Color<>clGreen then begin
                                                      isWordGreen:=false;
                                                      exit;
                                                      end;
  2:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i].Color<>clGreen then  begin
                                                      isWordGreen:=false;
                                                      exit;
                                                      end;
  3:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst+i].Color<>clGreen then begin
                                                      isWordGreen:=false;
                                                      exit;
                                                      end;
  4:for i:=0 to Words[num].length-1 do
      if Edits[Words[num].numfirst-i*EDINLINE].Color<>clGreen then begin
                                                      isWordGreen:=false;
                                                      exit;
                                                      end;
     end;
  isWordGreen:=true;
end;


function wrongWordsA():integer;
var i,wrong:integer;
begin
wrong:=0;
for i:=1 to wordsAmount do
  if (isWordFull(i)) and (not isWordRight(i))then inc(wrong);
wrongWordsA:=wrong;
end;

function isAllRight():boolean;
var i:integer;
begin
for i:=1 to wordsAmount do
 if (not isWordFull(i)) or (not isWordRight(i))then begin
                                                    isAllRight:=false;
                                                    exit;
                                                    end;
isAllRight:=true;                                                    
end;
////////////////////////////
////////////////////////////
///////////////////////////

procedure TForm1.FormCreate(Sender: TObject);
var i:integer;
begin
Form1.Left:=0;
Form1.Top:=0;
Splitter1.Top:=50;                               //ставим 2 панели,верхняя видимая(на ней находится ListBox)
Panel1.Align:=alTop;                             //нжняя-невидимая
Splitter1.Align:=alTop;                          //ставим между ними Splitter
Panel2.Align:=alClient;

ListBox1.Width:=Panel1.Width;                    //листбокс разворачиваем на всю панель
ListBox1.Height:=Panel1.Height;
ListBox1.Top:=Panel1.Top;
ListBox1.Left:=Panel1.Left;


wrongTries:=0;
wasWrong:=0;
Editsamount:=0;
for i:=0 to componentCount-1 do                  //до кол-ва едитов
if pos('Edit',form1.components[i].GetNamePath)<>0 then  begin                                             //если это едит
                                                        Edits[EditsAmount]:=(components[i] as TEdit);      //добавляем едит в массив
                                                        Edits[EditsAmount].Tag:=EditsAmount;        //номера эдитов
                                                        inc(EditsAmount);
                                                        end;
dec(EditsAmount);

for i:=0 to EditsAmount do
Edits[i].Visible:=false;
end;



procedure TForm1.N2Click(Sender: TObject);              //открытие крассворда
var i:integer;
Color:TColor;
text:string;
inEditsA,num:integer;
Ansv:integer;
begin

openDialog1.Filter :='Crossword|*.crs';
openDialog1.InitialDir:=GetCurrentDir;

if OpenDialog1.Execute then begin
                            AssignFile(input,OpenDialog1.FileName);
                            reset(input);

                            Timer1.Enabled:=false;
                            Timer2.Enabled:=false;
                            Label1.Visible:=false;
                            Label9.Visible:=false;

                            readln(time);
                            if time<>0 then begin
                                            Ansv:=MessageBox(Handle,PChar('Цей кросворд має обмеження по часу.Ви хочете почати гру,запустивши відлік?(ви матимете '+intToStr(time)+' секунд)'),PChar('Ограничение по времени'),MB_ICONINFORMATION+MB_OKCANCEL+MB_DEFBUTTON2);
                                            if Ansv=IDCANCEL then
                                                          exit;
                                            Timer1.Enabled:=true;
                                            Timer2.Enabled:=true;
                                            Label1.Visible:=true;
                                            Label1.Caption:='У вас залишилося '+intToStr(time)+' cекунд';
                                            end;
                            Panel4.Visible:=false;
                            Panel1.Visible:=true;
                            Panel3.Visible:=false;
                            Panel5.Visible:=false;
                            Panel6.Visible:=false;
                            Panel7.Visible:=false;
                            wasWrong:=0;
                            wrongTries:=0;
                            
                            for i:=0 to EditsAmount do
                            Edits[i].Text:='';



                           for i:=0 to EditsAmount do
                             readln(Letters[i]);

                            for i:=0 to EditsAmount do
                            begin
                              readln(color);
                              if color<>clNone then begin
                                                    Edits[i].Color:=clWindow;
                                                    Edits[i].Visible:=true;
                                                    end
                                                     else begin
                                                              Edits[i].Visible:=False;
                                                              Edits[i].Color:=clNone;
                                                              end;
                            end;

                            for i:=0 to EditsAmount do
                            if Edits[i].Color=clNone then Edits[i].ReadOnly:=true else Edits[i].Readonly:=false;

                            readln(wordsAmount);
                            for i:=1 to wordsAmount do
                              readln(Words[i].numfirst,Words[i].length,Words[i].direction);

                            ListBox1.Items.Clear;             //очищаем ListBox от лишнего

                            for i:=1 to wordsAmount do           //считываем вопросы и вносим их в ListBox
                            begin
                              readln(Words[i].question);
                              ListBox1.Items[i-1]:=intToStr(i)+'.'+Words[i].question;
                              if i<wordsamount then ListBox1.Items.Add('');
                            end;



                               readln(inEditsA);                     //считываем кол-во букв,уже записаных в едиты  в тхт. файле записан номер едита и буква в нем
                            for i:=1 to inEditsA do
                            begin
                              readln(num,text);
                              delete(text,1,1);
                              Edits[num].Text:=text;
                            end;

                            if time<>0 then Timer1.Interval:=time*1000;
                            CloseFile(input);
                             end;


end;

procedure TForm1.Edit1Change(Sender: TObject);          //изменение едита
var s:string;
i:integer;
begin
with (Sender as Tedit) do
begin
  s:=Edits[Tag].Text;
  if (length(s)=2) and (s[1]<>' ') then delete(s,1,1);   //если пробел заменили на какой-то символ
  if s<>'' then begin
            if ((ord(s[1])>=ord('а')) and (ord(s[1])<=ord('я'))) or ((ord(s[1])>=ord('a')) and (ord(s[1])<=ord('z')))   then s[1]:=chr(ord(s[1])-32);       //маленькие буквы в большие
            if ((ord(s[2])>=ord('а')) and (ord(s[2])<=ord('я'))) or ((ord(s[2])>=ord('a')) and (ord(s[2])<=ord('z')))   then s[2]:=chr(ord(s[2])-32);
            if s[1]='ї' then s[1]:='Ї';
            if s[2]='ї' then s[2]:='Ї';

            if s[1]='ґ' then s[1]:='Ґ';
            if s[2]='ґ' then s[2]:='Ґ';

            if s[1]='і' then s[1]:='І';
            if s[2]='і' then s[1]:='І';

            if s[1]='є' then s[1]:='Є';
            if s[2]='є' then s[2]:='Є';

            if (((ord(s[1])>=ord('A')) and (ord(s[1])<=ord('Z'))) or ((ord(s[1])>=ord('А')) and (ord(s[1])<=ord('Я'))) or (ord(s[1])=39) or (s[1]=' ') or (s[1]='І') or (s[1]='Ґ') or (s[1]='Є') or (s[1]='-') or (s[1]='Ї') or (s[1]='’') or (s[1]='‘'))
                and (((ord(s[2])>=ord('A')) and (ord(s[2])<=ord('Z'))) or ((ord(s[2])>=ord('А')) and (ord(s[2])<=ord('Я'))) or (ord(s[2])=39) or  (s[2]='І') or (s[2]='Ґ') or (s[2]='Є') or (s[2]='-') or (s[2]='Ї') or (s[2]='’') or (s[2]='‘') or (length(s)=1)) then begin          //если первый и второй символы соответствуют условию (буквы+апостроф) тогда можно,иначе очищаем едит
                                                                                              if (length(s)<2) and (length(s)<>0) then                               //добавление и удаление пробелов для букв
                                                                                                                            Edits[Tag].Text:=' '+s
                                                                                                                                  else
                                                                                                                            Edits[Tag].Text:=s;

                                                                                               if (Edits[Tag].Text='  ') or (Edits[Tag].Text=' ') then Edits[Tag].Text:='';
                                                                                                                                          end
                                                                                                                                          else Edits[Tag].Text:='';
                 end;


Edits[Tag].SetFocus;
Edits[Tag].SelStart:=2;


for i:=1 to wordsAmount do                  //если слово заполнено,проверяем его на правильность
  begin
   if isWordFull(i) then
                      if isWordRight(i) then paintGreen(i) else paintRed(i)
                       else
                         paintWhite(i);

  end;
for i:=1 to wordsAmount do
  if (isWordFull(i)) and not( isWordRight(i)) then paintRed(i);

  for i:=1 to wordsAmount do
  if isWordRight(i) then paintGreen(i);

if wrongWordsA()>waswrong then begin                            //считаем кол-во неправильных попыток
                               inc(wrongTries);
                               waswrong:=wrongWordsA();
                               end
                           else waswrong:=wrongWordsA();


if isAllRight()=true then begin
                          Panel4.Visible:=true;
                          Panel4.Top:=0;
                          Panel4.Left:=0;
                          Panel4.Width:=870;                //890
                          Panel4.Height:=630;                //651
                          Panel1.Visible:=false;
                          Label2.Caption:='Вітаємо!!!';
                          Label3.Caption:='Вы вирішили кросворд';
                          Label7.Caption:=intToStr(wrongTries);
                          Label8.Caption:=intToStr(wordsAmount);
                          if time<>0 then begin
                                          Label9.Visible:=true;
                                          Label9.Caption:='У вас залишилося ще '+intToStr(time)+' секунд';
                                          end
                                          else Label9.Visible:=false;
                          Timer1.Enabled:=false;
                          Timer2.Enabled:=false;
                          Label1.Visible:=false;
                          end;


end;
end;



procedure TForm1.Splitter1Moved(Sender: TObject);          //разворачиваем ListBox на всю панель
begin
ListBox1.Width:=Panel1.Width;
ListBox1.Height:=Panel1.Height;
ListBox1.Top:=Panel1.Top;
ListBox1.Left:=Panel1.Left;
end;



procedure TForm1.ListBox1Click(Sender: TObject);                           //клик на вопрос
var i:integer;
begin
for i:=0 to EditsAmount do                                               //Возвращаем цвета едитам
if Edits[i].Color<>clNone then Edits[i].Color:=clWindow;
Panel3.Visible:=true;                                                  //Делаем картинку с направлением видимой


case Words[ListBox1.ItemIndex+1].direction of                            //смотрим по направлению слова и на 1й едит ставим стрелку с направлением
1: begin                                                                 //вниз
     for i:=0 to Words[ListBox1.ItemIndex+1].length-1 do
       Edits[Words[ListBox1.ItemIndex+1].numfirst+i*EDINLINE].Color:=clPurple;

     Panel3.Visible:=true;
     Panel3.Left:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Left;
     Panel3.Top:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Top;
     Panel5.Visible:=false;
     Panel6.Visible:=false;
     Panel7.Visible:=false;
   end;

4: begin                                                                     //вверх
    for i:=0 to Words[ListBox1.ItemIndex+1].length-1 do
       Edits[Words[ListBox1.ItemIndex+1].numfirst-i*EDINLINE].Color:=clPurple;

    Panel5.Visible:=true;
    Panel5.Left:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Left;
    Panel5.Top:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Top;
    Panel3.Visible:=false;
    Panel6.Visible:=false;
    Panel7.Visible:=false;
   end;

2: begin                                                                //влево
    for i:=0 to Words[ListBox1.ItemIndex+1].length-1 do
       Edits[Words[ListBox1.ItemIndex+1].numfirst-i].Color:=clPurple;

    Panel6.Visible:=true;
    Panel6.Left:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Left;
    Panel6.Top:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Top;
    Panel5.Visible:=false;
    Panel3.Visible:=false;
    Panel7.Visible:=false;
   end;

3: begin                                                                       //вправо
    for i:=0 to Words[ListBox1.ItemIndex+1].length-1 do
       Edits[Words[ListBox1.ItemIndex+1].numfirst+i].Color:=clPurple;

    Panel7.Visible:=true;
    Panel7.Left:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Left;
    Panel7.Top:=Edits[Words[ListBox1.ItemIndex+1].numfirst].Top;
    Panel3.Visible:=false;
    Panel5.Visible:=false;
    Panel6.Visible:=false;
   end;

end;
end;

procedure TForm1.FormClick(Sender: TObject);                     //при клике делаем стрелку невидимой и возвращаем цвета едитам
var i:integer;
begin
Panel3.Visible:=false;
Panel5.Visible:=false;
Panel6.Visible:=false;
Panel7.Visible:=false;
for i:=0 to EditsAmount do
if Edits[i].Color<>clNone then Edits[i].Color:=clWindow;

 for i:=1 to wordsAmount do                  //если слово заполнено,проверяем его на правильность
  begin
   if isWordFull(i) then
                      if isWordRight(i) then paintGreen(i) else paintRed(i)
                       else
                        if isWordGreen(i) then paintWhite(i);
   end;
end;

procedure TForm1.Edit1Click(Sender: TObject);               //при клике делаем стрелку невидимой и возвращаем цвета едит
var i:integer;
begin
Panel3.Visible:=false;
Panel5.Visible:=false;
Panel6.Visible:=false;
Panel7.Visible:=false;
for i:=0 to EditsAmount do
if (Edits[i].Color<>clNone)  then Edits[i].Color:=clWindow;


  for i:=1 to wordsAmount do                  //если слово заполнено,проверяем его на правильность
  begin
   if isWordFull(i) then
                      if isWordRight(i) then paintGreen(i) else paintRed(i)
                       else
                        if isWordGreen(i) then paintWhite(i);

  end;
end;

procedure TForm1.Image1Click(Sender: TObject);
var i:integer;
begin
Panel3.Visible:=false;
Panel5.Visible:=false;
Panel6.Visible:=false;
Panel7.Visible:=false;
for i:=0 to EditsAmount do
if (Edits[i].Color<>clNone)then Edits[i].Color:=clWindow;

 for i:=1 to wordsAmount do                  //если слово заполнено,проверяем его на правильность
  begin
   if isWordFull(i) then
                      if isWordRight(i) then paintGreen(i) else paintRed(i)
                       else
                        if isWordGreen(i) then paintWhite(i);
   end;                     
end;

procedure TForm1.N3Click(Sender: TObject);
var i,inEditsA:integer;
begin
SaveDialog1.Filter:='Crossword|*.crs';
SaveDialog1.InitialDir := GetCurrentDir;
SaveDialog1.DefaultExt:='.crs';
inEditsA:=0;

if SaveDialog1.Execute then begin
                            if FileExists(SaveDialog1.Filename) then                         //если такой файл существует
                                                                 DeleteFile(SaveDialog1.FileName);
                            SaveDialog1.DefaultExt:='.crs';
                            AssignFile(output,SaveDialog1.FileName);
                            rewrite(output);

                            writeln(time);
                            for i:=0 to EditsAmount do
                               writeln(Letters[i]);

                            for i:=0 to EditsAmount do
                               writeln(Edits[i].Color);


                             writeln(wordsamount);
                             for i:=1 to wordsAmount do
                               writeln(Words[i].numfirst,' ',Words[i].length,' ',Words[i].direction);

                             for i:=1 to wordsAmount do
                               writeln(Words[i].question);

                             for i:=0 to EditsAmount do
                               if Edits[i].Text<>'' then  inc(inEditsA);

                             writeln(inEditsA);

                             for i:=0 to EditsAmount do
                               if Edits[i].Text<>'' then writeln(i,' ',Edits[i].Text);

                             for i:=0 to EditsAmount do
                              Letters[i]:='';



                            CloseFile(output);
                            end;
end;


procedure TForm1.Button1Click(Sender: TObject);
begin
Close;
end;

procedure TForm1.Timer1Timer(Sender:TObject);
var i,right:integer;
begin
   if wrongWordsA()>waswrong then begin                            //считаем кол-во неправильных попыток
                               inc(wrongTries);
                               waswrong:=wrongWordsA();
                               end
                           else waswrong:=wrongWordsA();
   for i:=1 to wordsAmount do
   if isWordRight(i) then inc(right);

   Panel4.Visible:=true;
   Panel4.Top:=0;
   Panel4.Left:=0;
   Panel4.Width:=870;                //890
   Panel4.Height:=630;                //651
   Panel1.Visible:=false;
   Label2.Caption:='Шкодуємо';
   Label3.Caption:='Ви не встигли вирішити кросворд вчасно';
   Label7.Caption:=intToStr(wrongTries);
   Label8.Caption:=intToStr(right);
   Timer1.Enabled:=false;
   Timer2.Enabled:=false;
   Label1.Visible:=false;

end;

procedure TForm1.Edit1KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
with (Sender as Tedit) do
case Key of
   38: if (Tag-EDINLINE>=0) and (Edits[Tag-EDINLINE].Visible=true) then begin                               //вверх
                                Edits[Tag-EDINLINE].SetFocus;
                                Edits[Tag-EDINLINE].SelStart:=2;
                                end;

   40: if (Tag+EDINLINE<=EditsAmount) and (Edits[Tag+EDINLINE].Visible=true) then begin                         //вниз
                                Edits[Tag+EDINLINE].SetFocus;
                                Edits[Tag+EDINLINE].SelStart:=2;
                                end;
   39: if (Tag+1<=EditsAmount) and (Edits[Tag+1].Visible=true) then begin                            //вправо
                                  Edits[Tag+1].SetFocus;
                                  Edits[Tag+1].SelStart:=2;
                                  end;
   37: if (Tag-1>=0) and (Edits[Tag-1].Visible=true) then begin                                 //влево
                                  Edits[Tag-1].SetFocus;
                                  Edits[Tag-1].SelStart:=2;
                        end;
end;
end;

procedure TForm1.N5Click(Sender: TObject);
var FileName:string;
begin
FileName:='Інструкція з використання Вирішувача кросвордів.txt';
if FileExists(FileName) then
                        ShellExecute(0,'Open',PChar(FileName),'',nil,1)
                         else begin
                             AssignFile(output,FileName);
                             Rewrite(output);
                             writeln('Інструкція з використання программи "Вирішувач кросвордів"');
                             writeln('Панель меню');
                             writeln('  1.Файл');
                             writeln('  В цьому розділі меню ви можете відкрити кросворд,який був створений');
                             writeln('  у "Створювачі кросвордів",чи був недоробленний у "Вирішувачі кросвордів".');
                             writeln('  Також тут ви можете зберігти недороблений кросворд.');
                             writeln('  2.Довідка');
                             writeln('  Довідка містиць інструкцію(те,що ви зараз читаєте) та інформацію про автора цієї программи.');
                             writeln('Робота з программою');
                             writeln('  Для роботи з программою вам потрібно відкрити кросворд за допомогою панелі меню:');
                             writeln('  Файл->Відкрити кросворд та обрати кросворд,створений у "Створювачі кросвордів",чи');
                             writeln('  збережений у "Вирішувачі кросвордів".');
                             writeln('  Після цих дій вам стане доступне поле кросворду для його вирішування.');
                             writeln('  Побачити питання ви можете у верхній частині программи.');
                             writeln('  Якщо ви хочете побачити,до якого слова належить це питання,клікніть по питанню і');
                             writeln('  ви побачите віділені клітинки,які належать до цього питання.Також за допомогою');
                             writeln('  стрілки ви можете побачити напрямок слова(стрілка знаходиться на початку слова');
                             writeln('  і вказує на кінець слова).Також ви можете перетягувати верхнє меню,чи прокручувати його');
                             writeln('  Якщо ви правильно відгадали слово,то воно пофарбується у червоний колір.Якщо ви допустили хоча б');
                             writeln('  одну помилку,слово пофарбується у червоний колір.Коли ви відгадаєте усі слова,ви зможете побачити');
                             writeln('  кількість неправильних спроб відгадати слово та кількість відгаданих слів.');
                             writeln;
                             writeln('  Якщо у кросворді є обмеження за часом,то при відкритті кросворду,у вас запитають,чи хочете ви почати ');
                             writeln('  вирішувати кросворд,запустивши відлік.При натисканні кнопки ОК,відлік починається і вам потрібно відгадати ');
                             writeln('  кросворд за відповідний час.');


                             CloseFile(output);
                             ShellExecute(0,'Open',PChar(FileName),'',nil,1);
                             end;

end;

procedure TForm1.Timer2Timer(Sender: TObject);
begin
dec(time);
Label1.Caption:='У вас залишилося '+intToStr(time)+' секунд';
end;

procedure TForm1.N6Click(Sender: TObject);
begin
Form2.Visible:=true;
end;

end.
